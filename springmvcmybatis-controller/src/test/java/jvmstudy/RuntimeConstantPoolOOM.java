package jvmstudy;

import java.util.ArrayList;
import java.util.List;

/**
 * 运行时常量池, 内存溢出.
 *
 * -XX:PermSize=10M  默认方法区的大小
 * -XX:MaxPermSize=10M  最大方法区大小
 *
 *
 * Created by Administrator on 2018/2/1 0001.
 */
public class RuntimeConstantPoolOOM {
    public static void main(String[] args) {
        // list中保存引用, 防止垃圾回收
        List<String> list = new ArrayList<>();
        String str = "11111111111111111111111111111111111111111111111111111111111111111111111111" +
                "11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                "111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                "111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                "11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111" +
                "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111";
        int i = 1;
        while (true){
            /*
            intern方法的作用是: 如果字符串常量池中有等于String的字符串, 则返回, 没有的话则把字符串加入到常量池里面
             */
            i++;
            list.add((str + i).intern());
        }
    }
}
